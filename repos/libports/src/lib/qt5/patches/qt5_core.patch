qt5_core.patch

From: Christian Prochaska <christian.prochaska@genode-labs.com>
From: Reinier Millo SÃ¡nchez <rmillo@uclv.cu>

---
 qtbase/include/QtCore/QtConfig                     |   1 +
 qtbase/include/QtCore/QtCoreDepends                |   3 +
 qtbase/include/QtCore/qconfig-genode.h             |   1 +
 qtbase/include/QtCore/qconfig.h                    |   1 +
 qtbase/include/QtCore/qfeatures.h                  |   1 +
 qtbase/src/corelib/codecs/qtextcodec.cpp           |   4 +
 qtbase/src/corelib/global/qconfig-genode.h         | 469 ++++++++++++++
 qtbase/src/corelib/global/qconfig.cpp              |  59 ++
 qtbase/src/corelib/global/qconfig.h                | 704 +++++++++++++++++++++
 qtbase/src/corelib/global/qfeatures.h              | 263 ++++++++
 qtbase/src/corelib/global/qglobal.h                |   8 +-
 qtbase/src/corelib/global/qlogging.cpp             |   8 +
 qtbase/src/corelib/global/qsystemdetection.h       |   5 +-
 qtbase/src/corelib/io/qprocess.cpp                 |  64 ++
 qtbase/src/corelib/io/qprocess_p.h                 |  45 +-
 qtbase/src/corelib/io/qresource.cpp                |   2 +-
 qtbase/src/corelib/kernel/qcoreapplication.cpp     |   2 +-
 .../src/corelib/kernel/qeventdispatcher_unix.cpp   |  14 +
 qtbase/src/corelib/kernel/qobject.h                |   2 +-
 qtbase/src/corelib/kernel/qtranslator.cpp          |   2 +-
 qtbase/src/corelib/kernel/qvariant_p.h             |   3 +
 qtbase/src/corelib/thread/qthread.cpp              |   3 +
 qtbase/src/corelib/thread/qthread_p.h              |  55 ++
 qtbase/src/corelib/tools/qarraydata.cpp            |   4 +-
 qtbase/src/corelib/tools/qdatetime.cpp             |   3 +
 25 files changed, 1716 insertions(+), 10 deletions(-)
 create mode 100644 qtbase/include/QtCore/QtConfig
 create mode 100644 qtbase/include/QtCore/QtCoreDepends
 create mode 100644 qtbase/include/QtCore/qconfig-genode.h
 create mode 100644 qtbase/include/QtCore/qconfig.h
 create mode 100644 qtbase/include/QtCore/qfeatures.h
 create mode 100644 qtbase/src/corelib/global/qconfig-genode.h
 create mode 100644 qtbase/src/corelib/global/qconfig.cpp
 create mode 100644 qtbase/src/corelib/global/qconfig.h
 create mode 100644 qtbase/src/corelib/global/qfeatures.h

diff --git a/qtbase/include/QtCore/QtConfig b/qtbase/include/QtCore/QtConfig
new file mode 100644
index 0000000..5f977a8
--- /dev/null
+++ b/qtbase/include/QtCore/QtConfig
@@ -0,0 +1 @@
+#include "qconfig.h"
\ No newline at end of file
diff --git a/qtbase/include/QtCore/QtCoreDepends b/qtbase/include/QtCore/QtCoreDepends
new file mode 100644
index 0000000..a953540
--- /dev/null
+++ b/qtbase/include/QtCore/QtCoreDepends
@@ -0,0 +1,3 @@
+/* This file was generated by qmake with the info from <root>/src/corelib/corelib.pro. */
+#ifdef __cplusplus /* create empty PCH in C mode */
+#endif
diff --git a/qtbase/include/QtCore/qconfig-genode.h b/qtbase/include/QtCore/qconfig-genode.h
new file mode 100644
index 0000000..2a8d3e1
--- /dev/null
+++ b/qtbase/include/QtCore/qconfig-genode.h
@@ -0,0 +1 @@
+#include "../../src/corelib/global/qconfig-genode.h"
diff --git a/qtbase/include/QtCore/qconfig.h b/qtbase/include/QtCore/qconfig.h
new file mode 100644
index 0000000..fdab094
--- /dev/null
+++ b/qtbase/include/QtCore/qconfig.h
@@ -0,0 +1 @@
+#include "../../src/corelib/global/qconfig.h"
\ No newline at end of file
diff --git a/qtbase/include/QtCore/qfeatures.h b/qtbase/include/QtCore/qfeatures.h
new file mode 100644
index 0000000..2501992
--- /dev/null
+++ b/qtbase/include/QtCore/qfeatures.h
@@ -0,0 +1 @@
+#include "../../src/corelib/global/qfeatures.h"
diff --git a/qtbase/src/corelib/codecs/qtextcodec.cpp b/qtbase/src/corelib/codecs/qtextcodec.cpp
index 8fef333..7bd519c 100644
--- a/qtbase/src/corelib/codecs/qtextcodec.cpp
+++ b/qtbase/src/corelib/codecs/qtextcodec.cpp
@@ -198,7 +198,11 @@ static QTextCodec *setupLocaleMapper()
         // First part is getting that locale name.  First try setlocale() which
         // definitely knows it, but since we cannot fully trust it, get ready
         // to fall back to environment variables.
+#ifdef Q_OS_GENODE
+       const QByteArray ctype;
+#else
         const QByteArray ctype = setlocale(LC_CTYPE, 0);
+#endif /* Q_OS_GENODE */
 
         // Get the first nonempty value from $LC_ALL, $LC_CTYPE, and $LANG
         // environment variables.
diff --git a/qtbase/src/corelib/global/qconfig-genode.h b/qtbase/src/corelib/global/qconfig-genode.h
new file mode 100644
index 0000000..2ec1b23
--- /dev/null
+++ b/qtbase/src/corelib/global/qconfig-genode.h
@@ -0,0 +1,469 @@
+/****************************************************************************
+**
+** Copyright (C) 2015 The Qt Company Ltd.
+** Contact: http://www.qt.io/licensing/
+**
+** This file is part of the QtCore module of the Qt Toolkit.
+**
+** $QT_BEGIN_LICENSE:LGPL21$
+** Commercial License Usage
+** Licensees holding valid commercial Qt licenses may use this file in
+** accordance with the commercial license agreement provided with the
+** Software or, alternatively, in accordance with the terms contained in
+** a written agreement between you and The Qt Company. For licensing terms
+** and conditions see http://www.qt.io/terms-conditions. For further
+** information use the contact form at http://www.qt.io/contact-us.
+**
+** GNU Lesser General Public License Usage
+** Alternatively, this file may be used under the terms of the GNU Lesser
+** General Public License version 2.1 or version 3 as published by the Free
+** Software Foundation and appearing in the file LICENSE.LGPLv21 and
+** LICENSE.LGPLv3 included in the packaging of this file. Please review the
+** following information to ensure the GNU Lesser General Public License
+** requirements will be met: https://www.gnu.org/licenses/lgpl.html and
+** http://www.gnu.org/licenses/old-licenses/lgpl-2.1.html.
+**
+** As a special exception, The Qt Company gives you certain additional
+** rights. These rights are described in The Qt Company LGPL Exception
+** version 1.1, included in the file LGPL_EXCEPTION.txt in this package.
+**
+** $QT_END_LICENSE$
+**
+****************************************************************************/
+
+/* Data structures */
+//#ifndef QT_NO_TEXTDATE
+//#  define QT_NO_TEXTDATE
+//#endif
+//#ifndef QT_NO_DATESTRING
+//#  define QT_NO_DATESTRING
+//#endif
+
+/* Dialogs */
+//#ifndef QT_NO_COLORDIALOG
+//#  define QT_NO_COLORDIALOG
+//#endif
+//#ifndef QT_NO_ERRORMESSAGE
+//#  define QT_NO_ERRORMESSAGE
+//#endif
+//#ifndef QT_NO_FILEDIALOG
+//#  define QT_NO_FILEDIALOG
+//#endif
+//#ifndef QT_NO_FONTDIALOG
+//#  define QT_NO_FONTDIALOG
+//#endif
+//#ifndef QT_NO_INPUTDIALOG
+//#  define QT_NO_INPUTDIALOG
+//#endif
+//#ifndef QT_NO_MESSAGEBOX
+//#  define QT_NO_MESSAGEBOX
+//#endif
+#ifndef QT_NO_PRINTDIALOG
+#  define QT_NO_PRINTDIALOG
+#endif
+#ifndef QT_NO_PRINTPREVIEWDIALOG
+#  define QT_NO_PRINTPREVIEWDIALOG
+#endif
+//#ifndef QT_NO_PROGRESSDIALOG
+//#  define QT_NO_PROGRESSDIALOG
+//#endif
+//#ifndef QT_NO_WIZARD
+//#  define QT_NO_WIZARD
+//#endif
+
+/* File I/O */
+//#ifndef QT_NO_DOM
+//#  define QT_NO_DOM
+//#endif
+//#ifndef QT_NO_FILESYSTEMWATCHER
+//#  define QT_NO_FILESYSTEMWATCHER
+//#endif
+//#ifndef QT_NO_FILESYSTEMMODEL
+//#  define QT_NO_FILESYSTEMMODEL
+//#endif
+//#ifndef QT_NO_PROCESS
+//#  define QT_NO_PROCESS
+//#endif
+//#ifndef QT_NO_TEMPORARYFILE
+//#  define QT_NO_TEMPORARYFILE
+//#endif
+//#ifndef QT_NO_SETTINGS
+//#  define QT_NO_SETTINGS
+//#endif
+//#ifndef QT_NO_LIBRARY
+//#  define QT_NO_LIBRARY
+//#endif
+
+/* Fonts */
+//#ifndef QT_NO_FREETYPE
+//#  define QT_NO_FREETYPE
+//#endif
+
+/* Images */
+//#ifndef QT_NO_IMAGEFORMATPLUGIN
+//#  define QT_NO_IMAGEFORMATPLUGIN
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_BMP
+//#  define QT_NO_IMAGEFORMAT_BMP
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_JPEG
+//#  define QT_NO_IMAGEFORMAT_JPEG
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_PNG
+//#  define QT_NO_IMAGEFORMAT_PNG
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_PPM
+//#  define QT_NO_IMAGEFORMAT_PPM
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_XBM
+//#  define QT_NO_IMAGEFORMAT_XBM
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_XPM
+//#  define QT_NO_IMAGEFORMAT_XPM
+//#endif
+//#ifndef QT_NO_IMAGE_HEURISTIC_MASK
+//#  define QT_NO_IMAGE_HEURISTIC_MASK
+//#endif
+//#ifndef QT_NO_MOVIE
+//#  define QT_NO_MOVIE
+//#endif
+
+/* Internationalization */
+//#ifndef QT_NO_BIG_CODECS
+//#  define QT_NO_BIG_CODECS
+//#endif
+//#ifndef QT_NO_TEXTCODEC
+//#  define QT_NO_TEXTCODEC
+//#endif
+//#ifndef QT_NO_CODECS
+//#  define QT_NO_CODECS
+//#endif
+//#ifndef QT_NO_TRANSLATION
+//#  define QT_NO_TRANSLATION
+//#endif
+
+/* ItemViews */
+//#ifndef QT_NO_ITEMVIEWS
+//#  define QT_NO_ITEMVIEWS
+//#endif
+//#ifndef QT_NO_DATAWIDGETMAPPER
+//#  define QT_NO_DATAWIDGETMAPPER
+//#endif
+//#ifndef QT_NO_DIRMODEL
+//#  define QT_NO_DIRMODEL
+//#endif
+//#ifndef QT_NO_LISTVIEW
+//#  define QT_NO_LISTVIEW
+//#endif
+//#ifndef QT_NO_COLUMNVIEW
+//#  define QT_NO_COLUMNVIEW
+//#endif
+//#ifndef QT_NO_PROXYMODEL
+//#  define QT_NO_PROXYMODEL
+//#endif
+//#ifndef QT_NO_SORTFILTERPROXYMODEL
+//#  define QT_NO_SORTFILTERPROXYMODEL
+//#endif
+//#ifndef QT_NO_STANDARDITEMMODEL
+//#  define QT_NO_STANDARDITEMMODEL
+//#endif
+//#ifndef QT_NO_STRINGLISTMODEL
+//#  define QT_NO_STRINGLISTMODEL
+//#endif
+//#ifndef QT_NO_TABLEVIEW
+//#  define QT_NO_TABLEVIEW
+//#endif
+//#ifndef QT_NO_TREEVIEW
+//#  define QT_NO_TREEVIEW
+//#endif
+
+/* Kernel */
+//#ifndef QT_NO_ACTION
+//#  define QT_NO_ACTION
+//#endif
+//#ifndef QT_NO_CLIPBOARD
+//#  define QT_NO_CLIPBOARD
+//#endif
+//#ifndef QT_NO_CSSPARSER
+//#  define QT_NO_CSSPARSER
+//#endif
+//#ifndef QT_NO_CURSOR
+//#  define QT_NO_CURSOR
+//#endif
+//#ifndef QT_NO_DRAGANDDROP
+//#  define QT_NO_DRAGANDDROP
+//#endif
+//#ifndef QT_NO_EFFECTS
+//#  define QT_NO_EFFECTS
+//#endif
+//#ifndef QT_NO_PROPERTIES
+//#  define QT_NO_PROPERTIES
+//#endif
+#ifndef QT_NO_SESSIONMANAGER
+#  define QT_NO_SESSIONMANAGER
+#endif
+#ifndef QT_NO_SHAREDMEMORY
+#  define QT_NO_SHAREDMEMORY
+#endif
+//#ifndef QT_NO_SHORTCUT
+//#  define QT_NO_SHORTCUT
+//#endif
+#ifndef QT_NO_SYSTEMSEMAPHORE
+#  define QT_NO_SYSTEMSEMAPHORE
+#endif
+//#ifndef QT_NO_TABLETEVENT
+//#  define QT_NO_TABLETEVENT
+//#endif
+//#ifndef QT_NO_TEXTHTMLPARSER
+//#  define QT_NO_TEXTHTMLPARSER
+//#endif
+#ifndef QT_NO_CONCURRENT
+#  define QT_NO_CONCURRENT
+#endif
+//#ifndef QT_NO_WHEELEVENT
+//#  define QT_NO_WHEELEVENT
+//#endif
+//#ifndef QT_NO_XMLSTREAM
+//#  define QT_NO_XMLSTREAM
+//#endif
+//#ifndef QT_NO_XMLSTREAMREADER
+//#  define QT_NO_XMLSTREAMREADER
+//#endif
+//#ifndef QT_NO_XMLSTREAMWRITER
+//#  define QT_NO_XMLSTREAMWRITER
+//#endif
+
+/* Networking */
+//#ifndef QT_NO_HTTP
+//#  define QT_NO_HTTP
+//#endif
+//#ifndef QT_NO_NETWORKPROXY
+//#  define QT_NO_NETWORKPROXY
+//#endif
+//#ifndef QT_NO_SOCKS5
+//#  define QT_NO_SOCKS5
+//#endif
+#ifndef QT_NO_UDPSOCKET
+#  define QT_NO_UDPSOCKET
+#endif
+#ifndef QT_NO_FTP
+#  define QT_NO_FTP
+#endif
+/* found in source files */
+//#ifndef QT_NO_LOCALSOCKET
+//#  define QT_NO_LOCALSOCKET
+//#endif
+//#ifndef QT_NO_LOCALSERVER
+//#  define QT_NO_LOCALSERVER
+//#endif
+#ifndef QT_NO_NETWORKINTERFACE
+#  define QT_NO_NETWORKINTERFACE
+#endif
+
+
+/* Painting */
+//#ifndef QT_NO_COLORNAMES
+//#  define QT_NO_COLORNAMES
+//#endif
+//#ifndef QT_NO_PAINT_DEBUG
+//#  define QT_NO_PAINT_DEBUG
+//#endif
+//#ifndef QT_NO_PICTURE
+//#  define QT_NO_PICTURE
+//#endif
+#ifndef QT_NO_PRINTER
+#  define QT_NO_PRINTER
+#endif
+#ifndef QT_NO_CUPS
+#  define QT_NO_CUPS
+#endif
+
+/* Styles */
+//#ifndef QT_NO_STYLE_FUSION
+//#  define QT_NO_STYLE_FUSION
+//#endif
+//#ifndef QT_NO_STYLE_STYLESHEET
+//#  define QT_NO_STYLE_STYLESHEET
+//#endif
+//#ifndef QT_NO_STYLE_WINDOWSCE
+//#  define QT_NO_STYLE_WINDOWSCE
+//#endif
+//#ifndef QT_NO_STYLE_WINDOWSMOBILE
+//#  define QT_NO_STYLE_WINDOWSMOBILE
+//#endif
+//#ifndef QT_NO_STYLE_WINDOWSVISTA
+//#  define QT_NO_STYLE_WINDOWSVISTA
+//#endif
+//#ifndef QT_NO_STYLE_WINDOWSXP
+//#  define QT_NO_STYLE_WINDOWSXP
+//#endif
+
+/* Utilities */
+//#ifndef QT_NO_ACCESSIBILITY
+//#  define QT_NO_ACCESSIBILITY
+//#endif
+//#ifndef QT_NO_COMPLETER
+//#  define QT_NO_COMPLETER
+//#endif
+//#ifndef QT_NO_DESKTOPSERVICES
+//#  define QT_NO_DESKTOPSERVICES
+//#endif
+//#ifndef QT_NO_SCRIPT
+//#  define QT_NO_SCRIPT
+//#endif
+//#ifndef QT_NO_SYSTEMTRAYICON
+//#  define QT_NO_SYSTEMTRAYICON
+//#endif
+//#ifndef QT_NO_UNDOCOMMAND
+//#  define QT_NO_UNDOCOMMAND
+//#endif
+//#ifndef QT_NO_UNDOGROUP
+//#  define QT_NO_UNDOGROUP
+//#endif
+//#ifndef QT_NO_UNDOSTACK
+//#  define QT_NO_UNDOSTACK
+//#endif
+//#ifndef QT_NO_UNDOVIEW
+//#  define QT_NO_UNDOVIEW
+//#endif
+//#ifndef QT_NO_GESTURES
+//#  define QT_NO_GESTURES
+//#endif
+
+/* Widgets */
+//#ifndef QT_NO_GROUPBOX
+//#  define QT_NO_GROUPBOX
+//#endif
+//#ifndef QT_NO_BUTTONGROUP
+//#  define QT_NO_BUTTONGROUP
+//#endif
+//#ifndef QT_NO_LCDNUMBER
+//#  define QT_NO_LCDNUMBER
+//#endif
+//#ifndef QT_NO_LINEEDIT
+//#  define QT_NO_LINEEDIT
+//#endif
+//#ifndef QT_NO_COMBOBOX
+//#  define QT_NO_COMBOBOX
+//#endif
+//#ifndef QT_NO_FONTCOMBOBOX
+//#  define QT_NO_FONTCOMBOBOX
+//#endif
+//#ifndef QT_NO_SPINBOX
+//#  define QT_NO_SPINBOX
+//#endif
+//#ifndef QT_NO_CALENDARWIDGET
+//#  define QT_NO_CALENDARWIDGET
+//#endif
+//#ifndef QT_NO_DATETIMEEDIT
+//#  define QT_NO_DATETIMEEDIT
+//#endif
+//#ifndef QT_NO_LISTWIDGET
+//#  define QT_NO_LISTWIDGET
+//#endif
+//#ifndef QT_NO_MENU
+//#  define QT_NO_MENU
+//#endif
+//#ifndef QT_NO_CONTEXTMENU
+//#  define QT_NO_CONTEXTMENU
+//#endif
+//#ifndef QT_NO_MAINWINDOW
+//#  define QT_NO_MAINWINDOW
+//#endif
+//#ifndef QT_NO_DOCKWIDGET
+//#  define QT_NO_DOCKWIDGET
+//#endif
+//#ifndef QT_NO_TOOLBAR
+//#  define QT_NO_TOOLBAR
+//#endif
+//#ifndef QT_NO_MENUBAR
+//#  define QT_NO_MENUBAR
+//#endif
+//#ifndef QT_NO_PROGRESSBAR
+//#  define QT_NO_PROGRESSBAR
+//#endif
+//#ifndef QT_NO_RESIZEHANDLER
+//#  define QT_NO_RESIZEHANDLER
+//#endif
+//#ifndef QT_NO_RUBBERBAND
+//#  define QT_NO_RUBBERBAND
+//#endif
+//#ifndef QT_NO_SPLITTER
+//#  define QT_NO_SPLITTER
+//#endif
+//#ifndef QT_NO_SIZEGRIP
+//#  define QT_NO_SIZEGRIP
+//#endif
+//#ifndef QT_NO_SLIDER
+//#  define QT_NO_SLIDER
+//#endif
+//#ifndef QT_NO_DIAL
+//#  define QT_NO_DIAL
+//#endif
+//#ifndef QT_NO_SCROLLBAR
+//#  define QT_NO_SCROLLBAR
+//#endif
+//#ifndef QT_NO_SCROLLAREA
+//#  define QT_NO_SCROLLAREA
+//#endif
+//#ifndef QT_NO_GRAPHICSVIEW
+//#  define QT_NO_GRAPHICSVIEW
+//#endif
+//#ifndef QT_NO_PRINTPREVIEWWIDGET
+//#  define QT_NO_PRINTPREVIEWWIDGET
+//#endif
+//#ifndef QT_NO_MDIAREA
+//#  define QT_NO_MDIAREA
+//#endif
+//#ifndef QT_NO_TEXTEDIT
+//#  define QT_NO_TEXTEDIT
+//#endif
+//#ifndef QT_NO_SYNTAXHIGHLIGHTER
+//#  define QT_NO_SYNTAXHIGHLIGHTER
+//#endif
+//#ifndef QT_NO_TEXTBROWSER
+//#  define QT_NO_TEXTBROWSER
+//#endif
+//#ifndef QT_NO_SPINWIDGET
+//#  define QT_NO_SPINWIDGET
+//#endif
+//#ifndef QT_NO_SPLASHSCREEN
+//#  define QT_NO_SPLASHSCREEN
+//#endif
+//#ifndef QT_NO_STACKEDWIDGET
+//#  define QT_NO_STACKEDWIDGET
+//#endif
+//#ifndef QT_NO_TABWIDGET
+//#  define QT_NO_TABWIDGET
+//#endif
+//#ifndef QT_NO_STATUSBAR
+//#  define QT_NO_STATUSBAR
+//#endif
+//#ifndef QT_NO_STATUSTIP
+//#  define QT_NO_STATUSTIP
+//#endif
+//#ifndef QT_NO_TABLEWIDGET
+//#  define QT_NO_TABLEWIDGET
+//#endif
+//#ifndef QT_NO_TOOLBUTTON
+//#  define QT_NO_TOOLBUTTON
+//#endif
+//#ifndef QT_NO_TABBAR
+//#  define QT_NO_TABBAR
+//#endif
+//#ifndef QT_NO_TOOLBOX
+//#  define QT_NO_TOOLBOX
+//#endif
+//#ifndef QT_NO_WHATSTHIS
+//#  define QT_NO_WHATSTHIS
+//#endif
+//#ifndef QT_NO_TOOLTIP
+//#  define QT_NO_TOOLTIP
+//#endif
+//#ifndef QT_NO_TREEWIDGET
+//#  define QT_NO_TREEWIDGET
+//#endif
+//#ifndef QT_NO_VALIDATOR
+//#  define QT_NO_VALIDATOR
+//#endif
+
diff --git a/qtbase/src/corelib/global/qconfig.cpp b/qtbase/src/corelib/global/qconfig.cpp
new file mode 100644
index 0000000..dfaabd0
--- /dev/null
+++ b/qtbase/src/corelib/global/qconfig.cpp
@@ -0,0 +1,59 @@
+/* License Info */
+static const char qt_configure_licensee_str          [256 + 12] = "qt_lcnsuser=Open Source";
+static const char qt_configure_licensed_products_str [256 + 12] = "qt_lcnsprod=OpenSource";
+
+/* Installation date */
+static const char qt_configure_installation          [12+11]    = "qt_instdate=2015-12-03";
+
+/* Installation Info */
+static const char qt_configure_prefix_path_str       [256 + 12] = "qt_prfxpath=/qt";
+#ifdef QT_BUILD_QMAKE
+static const char qt_configure_ext_prefix_path_str   [256 + 12] = "qt_epfxpath=/qt";
+static const char qt_configure_host_prefix_path_str  [256 + 12] = "qt_hpfxpath=/qt";
+#endif
+
+static const short qt_configure_str_offsets[] = {
+     0, 4, 12, 16, 24, 28, 36, 44, 48, 50, 52, 65, 74,
+#ifdef QT_BUILD_QMAKE
+     80, 81, 85, 89, 91, 102,
+#endif
+};
+static const char qt_configure_strs[] =
+    "doc\0"
+    "include\0"
+    "lib\0"
+    "libexec\0"
+    "bin\0"
+    "plugins\0"
+    "imports\0"
+    "qml\0"
+    ".\0"
+    ".\0"
+    "translations\0"
+    "examples\0"
+    "tests\0"
+#ifdef QT_BUILD_QMAKE
+    "\0"
+    "bin\0"
+    "lib\0"
+    ".\0"
+    "genode-g++\0"
+    "linux-g++\0"
+#endif
+;
+
+#define QT_CONFIGURE_SETTINGS_PATH "etc/xdg"
+
+#ifdef QT_BUILD_QMAKE
+# define QT_CONFIGURE_SYSROOTIFY_PREFIX false
+#endif
+
+/* strlen( "qt_lcnsxxxx" ) == 12 */
+#define QT_CONFIGURE_LICENSEE qt_configure_licensee_str + 12
+#define QT_CONFIGURE_LICENSED_PRODUCTS qt_configure_licensed_products_str + 12
+
+#define QT_CONFIGURE_PREFIX_PATH qt_configure_prefix_path_str + 12
+#ifdef QT_BUILD_QMAKE
+# define QT_CONFIGURE_EXT_PREFIX_PATH qt_configure_ext_prefix_path_str + 12
+# define QT_CONFIGURE_HOST_PREFIX_PATH qt_configure_host_prefix_path_str + 12
+#endif
diff --git a/qtbase/src/corelib/global/qconfig.h b/qtbase/src/corelib/global/qconfig.h
new file mode 100644
index 0000000..0cad703
--- /dev/null
+++ b/qtbase/src/corelib/global/qconfig.h
@@ -0,0 +1,704 @@
+/* Data structures */
+#ifndef QT_NO_STL
+#  define QT_NO_STL
+#endif
+//#ifndef QT_NO_TEXTDATE
+//#  define QT_NO_TEXTDATE
+//#endif
+//#ifndef QT_NO_DATESTRING
+//#  define QT_NO_DATESTRING
+//#endif
+
+/* Dialogs */
+//#ifndef QT_NO_COLORDIALOG
+//#  define QT_NO_COLORDIALOG
+//#endif
+//#ifndef QT_NO_ERRORMESSAGE
+//#  define QT_NO_ERRORMESSAGE
+//#endif
+//#ifndef QT_NO_FILEDIALOG
+//#  define QT_NO_FILEDIALOG
+//#endif
+//#ifndef QT_NO_FONTDIALOG
+//#  define QT_NO_FONTDIALOG
+//#endif
+//#ifndef QT_NO_INPUTDIALOG
+//#  define QT_NO_INPUTDIALOG
+//#endif
+//#ifndef QT_NO_MESSAGEBOX
+//#  define QT_NO_MESSAGEBOX
+//#endif
+#ifndef QT_NO_PRINTDIALOG
+#  define QT_NO_PRINTDIALOG
+#endif
+#ifndef QT_NO_PRINTPREVIEWDIALOG
+#  define QT_NO_PRINTPREVIEWDIALOG
+#endif
+//#ifndef QT_NO_PROGRESSDIALOG
+//#  define QT_NO_PROGRESSDIALOG
+//#endif
+//#ifndef QT_NO_TABDIALOG
+//#  define QT_NO_TABDIALOG
+//#endif
+//#ifndef QT_NO_WIZARD
+//#  define QT_NO_WIZARD
+//#endif
+
+/* File I/O */
+//#ifndef QT_NO_DOM
+//#  define QT_NO_DOM
+//#endif
+//#ifndef QT_NO_FILESYSTEMWATCHER
+//#  define QT_NO_FILESYSTEMWATCHER
+//#endif
+//#ifndef QT_NO_FILESYSTEMMODEL
+//#  define QT_NO_FILESYSTEMMODEL
+//#endif
+//#ifndef QT_NO_PROCESS
+//#  define QT_NO_PROCESS
+//#endif
+//#ifndef QT_NO_TEMPORARYFILE
+//#  define QT_NO_TEMPORARYFILE
+//#endif
+//#ifndef QT_NO_SETTINGS
+//#  define QT_NO_SETTINGS
+//#endif
+//#ifndef QT_NO_LIBRARY
+//#  define QT_NO_LIBRARY
+//#endif
+
+/* Fonts */
+//#ifndef QT_NO_FREETYPE
+//#  define QT_NO_FREETYPE
+//#endif
+#ifndef QT_NO_QWS_QPF2
+#  define QT_NO_QWS_QPF2
+#endif
+
+/* Images */
+//#ifndef QT_NO_IMAGEFORMATPLUGIN
+//#  define QT_NO_IMAGEFORMATPLUGIN
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_BMP
+//#  define QT_NO_IMAGEFORMAT_BMP
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_JPEG
+//#  define QT_NO_IMAGEFORMAT_JPEG
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_PNG
+//#  define QT_NO_IMAGEFORMAT_PNG
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_PPM
+//#  define QT_NO_IMAGEFORMAT_PPM
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_XBM
+//#  define QT_NO_IMAGEFORMAT_XBM
+//#endif
+//#ifndef QT_NO_IMAGEFORMAT_XPM
+//#  define QT_NO_IMAGEFORMAT_XPM
+//#endif
+//#ifndef QT_NO_IMAGE_HEURISTIC_MASK
+//#  define QT_NO_IMAGE_HEURISTIC_MASK
+//#endif
+//#ifndef QT_NO_MOVIE
+//#  define QT_NO_MOVIE
+//#endif
+
+/* Internationalization */
+//#ifndef QT_NO_BIG_CODECS
+//#  define QT_NO_BIG_CODECS
+//#endif
+//#ifndef QT_NO_QWS_INPUTMETHODS
+//#  define QT_NO_QWS_INPUTMETHODS
+//#endif
+//#ifndef QT_NO_TEXTCODEC
+//#  define QT_NO_TEXTCODEC
+//#endif
+//#ifndef QT_NO_CODECS
+//#  define QT_NO_CODECS
+//#endif
+//#ifndef QT_NO_TRANSLATION
+//#  define QT_NO_TRANSLATION
+//#endif
+//#ifndef QT_NO_TRANSLATION_UTF8
+//#  define QT_NO_TRANSLATION_UTF8
+//#endif
+
+/* ItemViews */
+//#ifndef QT_NO_ITEMVIEWS
+//#  define QT_NO_ITEMVIEWS
+//#endif
+//#ifndef QT_NO_DATAWIDGETMAPPER
+//#  define QT_NO_DATAWIDGETMAPPER
+//#endif
+//#ifndef QT_NO_DIRMODEL
+//#  define QT_NO_DIRMODEL
+//#endif
+//#ifndef QT_NO_LISTVIEW
+//#  define QT_NO_LISTVIEW
+//#endif
+//#ifndef QT_NO_COLUMNVIEW
+//#  define QT_NO_COLUMNVIEW
+//#endif
+//#ifndef QT_NO_PROXYMODEL
+//#  define QT_NO_PROXYMODEL
+//#endif
+//#ifndef QT_NO_SORTFILTERPROXYMODEL
+//#  define QT_NO_SORTFILTERPROXYMODEL
+//#endif
+//#ifndef QT_NO_STANDARDITEMMODEL
+//#  define QT_NO_STANDARDITEMMODEL
+//#endif
+//#ifndef QT_NO_STRINGLISTMODEL
+//#  define QT_NO_STRINGLISTMODEL
+//#endif
+//#ifndef QT_NO_TABLEVIEW
+//#  define QT_NO_TABLEVIEW
+//#endif
+//#ifndef QT_NO_TREEVIEW
+//#  define QT_NO_TREEVIEW
+//#endif
+
+/* Kernel */
+//#ifndef QT_NO_ACTION
+//#  define QT_NO_ACTION
+//#endif
+//#ifndef QT_NO_CLIPBOARD
+//#  define QT_NO_CLIPBOARD
+//#endif
+//#ifndef QT_NO_CSSPARSER
+//#  define QT_NO_CSSPARSER
+//#endif
+//#ifndef QT_NO_CURSOR
+//#  define QT_NO_CURSOR
+//#endif
+//#ifndef QT_NO_DRAGANDDROP
+//#  define QT_NO_DRAGANDDROP
+//#endif
+//#ifndef QT_NO_EFFECTS
+//#  define QT_NO_EFFECTS
+//#endif
+//#ifndef QT_NO_PROPERTIES
+//#  define QT_NO_PROPERTIES
+//#endif
+#ifndef QT_NO_SESSIONMANAGER
+#  define QT_NO_SESSIONMANAGER
+#endif
+#ifndef QT_NO_SHAREDMEMORY
+#  define QT_NO_SHAREDMEMORY
+#endif
+//#ifndef QT_NO_SHORTCUT
+//#  define QT_NO_SHORTCUT
+//#endif
+#ifndef QT_NO_SOUND
+#  define QT_NO_SOUND
+#endif
+#ifndef QT_NO_SYSTEMLOCALE
+#  define QT_NO_SYSTEMLOCALE
+#endif
+#ifndef QT_NO_SYSTEMSEMAPHORE
+#  define QT_NO_SYSTEMSEMAPHORE
+#endif
+//#ifndef QT_NO_TABLETEVENT
+//#  define QT_NO_TABLETEVENT
+//#endif
+//#ifndef QT_NO_TEXTHTMLPARSER
+//#  define QT_NO_TEXTHTMLPARSER
+//#endif
+#ifndef QT_NO_CONCURRENT
+#  define QT_NO_CONCURRENT
+#endif
+//#ifndef QT_NO_WHEELEVENT
+//#  define QT_NO_WHEELEVENT
+//#endif
+//#ifndef QT_NO_XMLSTREAM
+//#  define QT_NO_XMLSTREAM
+//#endif
+//#ifndef QT_NO_XMLSTREAMREADER
+//#  define QT_NO_XMLSTREAMREADER
+//#endif
+//#ifndef QT_NO_XMLSTREAMWRITER
+//#  define QT_NO_XMLSTREAMWRITER
+//#endif
+
+/* Networking */
+#ifndef QT_NO_COP
+#  define QT_NO_COP
+#endif
+//#ifndef QT_NO_HOSTINFO
+//#  define QT_NO_HOSTINFO
+//#endif
+//#ifndef QT_NO_HTTP
+//#  define QT_NO_HTTP
+//#endif
+//#ifndef QT_NO_NETWORKPROXY
+//#  define QT_NO_NETWORKPROXY
+//#endif
+//#ifndef QT_NO_SOCKS5
+//#  define QT_NO_SOCKS5
+//#endif
+#ifndef QT_NO_UDPSOCKET
+#  define QT_NO_UDPSOCKET
+#endif
+#ifndef QT_NO_URLINFO
+#  define QT_NO_URLINFO
+#endif
+#ifndef QT_NO_FTP
+#  define QT_NO_FTP
+#endif
+/* found in source files */
+//#ifndef QT_NO_LOCALSOCKET
+//#  define QT_NO_LOCALSOCKET
+//#endif
+//#ifndef QT_NO_LOCALSERVER
+//#  define QT_NO_LOCALSERVER
+//#endif
+#ifndef QT_NO_NETWORKINTERFACE
+#  define QT_NO_NETWORKINTERFACE
+#endif
+
+
+/* Painting */
+//#ifndef QT_NO_COLORNAMES
+//#  define QT_NO_COLORNAMES
+//#endif
+//#ifndef QT_NO_DIRECTPAINTER
+//#  define QT_NO_DIRECTPAINTER
+//#endif
+//#ifndef QT_NO_PAINTONSCREEN
+//#  define QT_NO_PAINTONSCREEN
+//#endif
+//#ifndef QT_NO_PAINT_DEBUG
+//#  define QT_NO_PAINT_DEBUG
+//#endif
+//#ifndef QT_NO_PICTURE
+//#  define QT_NO_PICTURE
+//#endif
+#ifndef QT_NO_PRINTER
+#  define QT_NO_PRINTER
+#endif
+#ifndef QT_NO_CUPS
+#  define QT_NO_CUPS
+#endif
+
+/* Qt for Embedded Linux */
+//#ifndef QT_NO_QWSEMBEDWIDGET
+//#  define QT_NO_QWSEMBEDWIDGET
+//#endif
+//#ifndef QT_NO_QWS_ALPHA_CURSOR
+//#  define QT_NO_QWS_ALPHA_CURSOR
+//#endif
+#ifndef QT_NO_QWS_CURSOR
+#  define QT_NO_QWS_CURSOR
+#endif
+//#ifndef QT_NO_QWS_DECORATION_DEFAULT
+//#  define QT_NO_QWS_DECORATION_DEFAULT
+//#endif
+//#ifndef QT_NO_QWS_DECORATION_STYLED
+//#  define QT_NO_QWS_DECORATION_STYLED
+//#endif
+//#ifndef QT_NO_QWS_DECORATION_WINDOWS
+//#  define QT_NO_QWS_DECORATION_WINDOWS
+//#endif
+//#ifndef QT_NO_QWS_MANAGER
+//#  define QT_NO_QWS_MANAGER
+//#endif
+//#ifndef QT_NO_QWS_KEYBOARD
+//#  define QT_NO_QWS_KEYBOARD
+//#endif
+//#ifndef QT_NO_QWS_MOUSE
+//#  define QT_NO_QWS_MOUSE
+//#endif
+//#ifndef QT_NO_QWS_MOUSE_AUTO
+//#  define QT_NO_QWS_MOUSE_AUTO
+//#endif
+//#ifndef QT_NO_QWS_MOUSE_MANUAL
+//#  define QT_NO_QWS_MOUSE_MANUAL
+//#endif
+#ifndef QT_NO_QWS_MULTIPROCESS
+#  define QT_NO_QWS_MULTIPROCESS
+#endif
+#ifndef QT_NO_QWS_SOUNDSERVER
+#  define QT_NO_QWS_SOUNDSERVER
+#endif
+//#ifndef QT_NO_QWS_PROPERTIES
+//#  define QT_NO_QWS_PROPERTIES
+//#endif
+//#ifndef QT_NO_QWS_PROXYSCREEN
+//#  define QT_NO_QWS_PROXYSCREEN
+//#endif
+//#ifndef QT_NO_QWS_DYNAMICSCREENTRANSFORMATION
+//#  define QT_NO_QWS_DYNAMICSCREENTRANSFORMATION
+//#endif
+
+/* SVG */
+//#ifndef QT_NO_SVG
+//#  define QT_NO_SVG
+//#endif
+//#ifndef QT_NO_GRAPHICSSVGITEM
+//#  define QT_NO_GRAPHICSSVGITEM
+//#endif
+//#ifndef QT_NO_SVGGENERATOR
+//#  define QT_NO_SVGGENERATOR
+//#endif
+//#ifndef QT_NO_SVGRENDERER
+//#  define QT_NO_SVGRENDERER
+//#endif
+//#ifndef QT_NO_SVGWIDGET
+//#  define QT_NO_SVGWIDGET
+//#endif
+
+/* Styles */
+//#ifndef QT_NO_STYLE_FUSION
+//#  define QT_NO_STYLE_FUSION
+//#endif
+//#ifndef QT_NO_STYLE_STYLESHEET
+//#  define QT_NO_STYLE_STYLESHEET
+//#endif
+//#ifndef QT_NO_STYLE_WINDOWSCE
+//#  define QT_NO_STYLE_WINDOWSCE
+//#endif
+//#ifndef QT_NO_STYLE_WINDOWSMOBILE
+//#  define QT_NO_STYLE_WINDOWSMOBILE
+//#endif
+//#ifndef QT_NO_STYLE_WINDOWSVISTA
+//#  define QT_NO_STYLE_WINDOWSVISTA
+//#endif
+//#ifndef QT_NO_STYLE_WINDOWSXP
+//#  define QT_NO_STYLE_WINDOWSXP
+//#endif
+
+/* Utilities */
+//#ifndef QT_NO_ACCESSIBILITY
+//#  define QT_NO_ACCESSIBILITY
+//#endif
+//#ifndef QT_NO_COMPLETER
+//#  define QT_NO_COMPLETER
+//#endif
+//#ifndef QT_NO_DESKTOPSERVICES
+//#  define QT_NO_DESKTOPSERVICES
+//#endif
+//#ifndef QT_NO_SCRIPT
+//#  define QT_NO_SCRIPT
+//#endif
+//#ifndef QT_NO_SYSTEMTRAYICON
+//#  define QT_NO_SYSTEMTRAYICON
+//#endif
+//#ifndef QT_NO_UNDOCOMMAND
+//#  define QT_NO_UNDOCOMMAND
+//#endif
+//#ifndef QT_NO_UNDOGROUP
+//#  define QT_NO_UNDOGROUP
+//#endif
+//#ifndef QT_NO_UNDOSTACK
+//#  define QT_NO_UNDOSTACK
+//#endif
+//#ifndef QT_NO_UNDOVIEW
+//#  define QT_NO_UNDOVIEW
+//#endif
+//#ifndef QT_NO_GESTURES
+//#  define QT_NO_GESTURES
+//#endif
+
+/* Widgets */
+//#ifndef QT_NO_GROUPBOX
+//#  define QT_NO_GROUPBOX
+//#endif
+//#ifndef QT_NO_BUTTONGROUP
+//#  define QT_NO_BUTTONGROUP
+//#endif
+//#ifndef QT_NO_LCDNUMBER
+//#  define QT_NO_LCDNUMBER
+//#endif
+//#ifndef QT_NO_LINEEDIT
+//#  define QT_NO_LINEEDIT
+//#endif
+//#ifndef QT_NO_COMBOBOX
+//#  define QT_NO_COMBOBOX
+//#endif
+//#ifndef QT_NO_FONTCOMBOBOX
+//#  define QT_NO_FONTCOMBOBOX
+//#endif
+//#ifndef QT_NO_SPINBOX
+//#  define QT_NO_SPINBOX
+//#endif
+//#ifndef QT_NO_CALENDARWIDGET
+//#  define QT_NO_CALENDARWIDGET
+//#endif
+//#ifndef QT_NO_DATETIMEEDIT
+//#  define QT_NO_DATETIMEEDIT
+//#endif
+//#ifndef QT_NO_LISTWIDGET
+//#  define QT_NO_LISTWIDGET
+//#endif
+//#ifndef QT_NO_MENU
+//#  define QT_NO_MENU
+//#endif
+//#ifndef QT_NO_CONTEXTMENU
+//#  define QT_NO_CONTEXTMENU
+//#endif
+//#ifndef QT_NO_MAINWINDOW
+//#  define QT_NO_MAINWINDOW
+//#endif
+//#ifndef QT_NO_DOCKWIDGET
+//#  define QT_NO_DOCKWIDGET
+//#endif
+//#ifndef QT_NO_TOOLBAR
+//#  define QT_NO_TOOLBAR
+//#endif
+//#ifndef QT_NO_MENUBAR
+//#  define QT_NO_MENUBAR
+//#endif
+//#ifndef QT_NO_PROGRESSBAR
+//#  define QT_NO_PROGRESSBAR
+//#endif
+//#ifndef QT_NO_RESIZEHANDLER
+//#  define QT_NO_RESIZEHANDLER
+//#endif
+//#ifndef QT_NO_RUBBERBAND
+//#  define QT_NO_RUBBERBAND
+//#endif
+//#ifndef QT_NO_SPLITTER
+//#  define QT_NO_SPLITTER
+//#endif
+//#ifndef QT_NO_SIGNALMAPPER
+//#  define QT_NO_SIGNALMAPPER
+//#endif
+//#ifndef QT_NO_SIZEGRIP
+//#  define QT_NO_SIZEGRIP
+//#endif
+//#ifndef QT_NO_SLIDER
+//#  define QT_NO_SLIDER
+//#endif
+//#ifndef QT_NO_DIAL
+//#  define QT_NO_DIAL
+//#endif
+//#ifndef QT_NO_SCROLLBAR
+//#  define QT_NO_SCROLLBAR
+//#endif
+//#ifndef QT_NO_SCROLLAREA
+//#  define QT_NO_SCROLLAREA
+//#endif
+//#ifndef QT_NO_GRAPHICSVIEW
+//#  define QT_NO_GRAPHICSVIEW
+//#endif
+//#ifndef QT_NO_PRINTPREVIEWWIDGET
+//#  define QT_NO_PRINTPREVIEWWIDGET
+//#endif
+//#ifndef QT_NO_MDIAREA
+//#  define QT_NO_MDIAREA
+//#endif
+//#ifndef QT_NO_TEXTEDIT
+//#  define QT_NO_TEXTEDIT
+//#endif
+//#ifndef QT_NO_SYNTAXHIGHLIGHTER
+//#  define QT_NO_SYNTAXHIGHLIGHTER
+//#endif
+//#ifndef QT_NO_TEXTBROWSER
+//#  define QT_NO_TEXTBROWSER
+//#endif
+//#ifndef QT_NO_SPINWIDGET
+//#  define QT_NO_SPINWIDGET
+//#endif
+//#ifndef QT_NO_SPLASHSCREEN
+//#  define QT_NO_SPLASHSCREEN
+//#endif
+//#ifndef QT_NO_STACKEDWIDGET
+//#  define QT_NO_STACKEDWIDGET
+//#endif
+//#ifndef QT_NO_TABWIDGET
+//#  define QT_NO_TABWIDGET
+//#endif
+//#ifndef QT_NO_STATUSBAR
+//#  define QT_NO_STATUSBAR
+//#endif
+//#ifndef QT_NO_STATUSTIP
+//#  define QT_NO_STATUSTIP
+//#endif
+//#ifndef QT_NO_TABLEWIDGET
+//#  define QT_NO_TABLEWIDGET
+//#endif
+//#ifndef QT_NO_TOOLBUTTON
+//#  define QT_NO_TOOLBUTTON
+//#endif
+//#ifndef QT_NO_TABBAR
+//#  define QT_NO_TABBAR
+//#endif
+//#ifndef QT_NO_TOOLBOX
+//#  define QT_NO_TOOLBOX
+//#endif
+//#ifndef QT_NO_WHATSTHIS
+//#  define QT_NO_WHATSTHIS
+//#endif
+//#ifndef QT_NO_TOOLTIP
+//#  define QT_NO_TOOLTIP
+//#endif
+//#ifndef QT_NO_TREEWIDGET
+//#  define QT_NO_TREEWIDGET
+//#endif
+//#ifndef QT_NO_VALIDATOR
+//#  define QT_NO_VALIDATOR
+//#endif
+
+/* Windows */
+//#ifndef QT_NO_WIN_ACTIVEQT
+//#  define QT_NO_WIN_ACTIVEQT
+//#endif#endif
+/* Compile time features */
+/* Compile time features */
+#if defined(__x86_64__)
+#  define QT_POINTER_SIZE 8
+#else
+#  define QT_POINTER_SIZE 4
+#endif
+#define QT_REDUCE_RELOCATIONS
+
+// Compiler sub-arch support
+
+#ifndef QT_BOOTSTRAPPED
+
+#include "qconfig-genode.h"
+
+#if defined(QT_BUILTIN_GIF_READER) && defined(QT_NO_BUILTIN_GIF_READER)
+# undef QT_BUILTIN_GIF_READER
+#elif !defined(QT_BUILTIN_GIF_READER) && !defined(QT_NO_BUILTIN_GIF_READER)
+# define QT_BUILTIN_GIF_READER 1
+#endif
+
+#if defined(QT_NO_ACCESSIBILITY) && defined(QT_ACCESSIBILITY)
+# undef QT_NO_ACCESSIBILITY
+#elif !defined(QT_NO_ACCESSIBILITY) && !defined(QT_ACCESSIBILITY)
+# define QT_NO_ACCESSIBILITY
+#endif
+
+#if defined(QT_NO_CUPS) && defined(QT_CUPS)
+# undef QT_NO_CUPS
+#elif !defined(QT_NO_CUPS) && !defined(QT_CUPS)
+# define QT_NO_CUPS
+#endif
+
+#if defined(QT_NO_DBUS) && defined(QT_DBUS)
+# undef QT_NO_DBUS
+#elif !defined(QT_NO_DBUS) && !defined(QT_DBUS)
+# define QT_NO_DBUS
+#endif
+
+#if defined(QT_NO_EVENTFD) && defined(QT_EVENTFD)
+# undef QT_NO_EVENTFD
+#elif !defined(QT_NO_EVENTFD) && !defined(QT_EVENTFD)
+# define QT_NO_EVENTFD
+#endif
+
+#if defined(QT_NO_FONTCONFIG) && defined(QT_FONTCONFIG)
+# undef QT_NO_FONTCONFIG
+#elif !defined(QT_NO_FONTCONFIG) && !defined(QT_FONTCONFIG)
+# define QT_NO_FONTCONFIG
+#endif
+
+#if defined(QT_NO_GLIB) && defined(QT_GLIB)
+# undef QT_NO_GLIB
+#elif !defined(QT_NO_GLIB) && !defined(QT_GLIB)
+# define QT_NO_GLIB
+#endif
+
+#if defined(QT_NO_ICONV) && defined(QT_ICONV)
+# undef QT_NO_ICONV
+#elif !defined(QT_NO_ICONV) && !defined(QT_ICONV)
+# define QT_NO_ICONV
+#endif
+
+#if defined(QT_NO_LIBPROXY) && defined(QT_LIBPROXY)
+# undef QT_NO_LIBPROXY
+#elif !defined(QT_NO_LIBPROXY) && !defined(QT_LIBPROXY)
+# define QT_NO_LIBPROXY
+#endif
+
+#if defined(QT_NO_NIS) && defined(QT_NIS)
+# undef QT_NO_NIS
+#elif !defined(QT_NO_NIS) && !defined(QT_NIS)
+# define QT_NO_NIS
+#endif
+
+#if defined(QT_NO_OPENSSL) && defined(QT_OPENSSL)
+# undef QT_NO_OPENSSL
+#elif !defined(QT_NO_OPENSSL) && !defined(QT_OPENSSL)
+# define QT_NO_OPENSSL
+#endif
+
+#if defined(QT_NO_OPENVG) && defined(QT_OPENVG)
+# undef QT_NO_OPENVG
+#elif !defined(QT_NO_OPENVG) && !defined(QT_OPENVG)
+# define QT_NO_OPENVG
+#endif
+
+#if defined(QT_NO_PULSEAUDIO) && defined(QT_PULSEAUDIO)
+# undef QT_NO_PULSEAUDIO
+#elif !defined(QT_NO_PULSEAUDIO) && !defined(QT_PULSEAUDIO)
+# define QT_NO_PULSEAUDIO
+#endif
+
+#if defined(QT_NO_SSL) && defined(QT_SSL)
+# undef QT_NO_SSL
+#elif !defined(QT_NO_SSL) && !defined(QT_SSL)
+# define QT_NO_SSL
+#endif
+
+#if defined(QT_NO_STYLE_GTK) && defined(QT_STYLE_GTK)
+# undef QT_NO_STYLE_GTK
+#elif !defined(QT_NO_STYLE_GTK) && !defined(QT_STYLE_GTK)
+# define QT_NO_STYLE_GTK
+#endif
+
+#if defined(QT_NO_TABLET) && defined(QT_TABLET)
+# undef QT_NO_TABLET
+#elif !defined(QT_NO_TABLET) && !defined(QT_TABLET)
+# define QT_NO_TABLET
+#endif
+
+#if defined(QT_NO_TSLIB) && defined(QT_TSLIB)
+# undef QT_NO_TSLIB
+#elif !defined(QT_NO_TSLIB) && !defined(QT_TSLIB)
+# define QT_NO_TSLIB
+#endif
+
+#if defined(QT_NO_XINPUT) && defined(QT_XINPUT)
+# undef QT_NO_XINPUT
+#elif !defined(QT_NO_XINPUT) && !defined(QT_XINPUT)
+# define QT_NO_XINPUT
+#endif
+
+#if defined(QT_NO_ZLIB) && defined(QT_ZLIB)
+# undef QT_NO_ZLIB
+#elif !defined(QT_NO_ZLIB) && !defined(QT_ZLIB)
+# define QT_NO_ZLIB
+#endif
+
+#if defined(QT_RUNTIME_XCURSOR) && defined(QT_NO_RUNTIME_XCURSOR)
+# undef QT_RUNTIME_XCURSOR
+#elif !defined(QT_RUNTIME_XCURSOR) && !defined(QT_NO_RUNTIME_XCURSOR)
+# define QT_RUNTIME_XCURSOR
+#endif
+
+#if defined(QT_RUNTIME_XFIXES) && defined(QT_NO_RUNTIME_XFIXES)
+# undef QT_RUNTIME_XFIXES
+#elif !defined(QT_RUNTIME_XFIXES) && !defined(QT_NO_RUNTIME_XFIXES)
+# define QT_RUNTIME_XFIXES
+#endif
+
+#if defined(QT_RUNTIME_XINERAMA) && defined(QT_NO_RUNTIME_XINERAMA)
+# undef QT_RUNTIME_XINERAMA
+#elif !defined(QT_RUNTIME_XINERAMA) && !defined(QT_NO_RUNTIME_XINERAMA)
+# define QT_RUNTIME_XINERAMA
+#endif
+
+#if defined(QT_RUNTIME_XRANDR) && defined(QT_NO_RUNTIME_XRANDR)
+# undef QT_RUNTIME_XRANDR
+#elif !defined(QT_RUNTIME_XRANDR) && !defined(QT_NO_RUNTIME_XRANDR)
+# define QT_RUNTIME_XRANDR
+#endif
+
+#endif // QT_BOOTSTRAPPED
+
+#define QT_VISIBILITY_AVAILABLE
+
+#define QT_QPA_DEFAULT_PLATFORM_NAME "nitpicker"
diff --git a/qtbase/src/corelib/global/qfeatures.h b/qtbase/src/corelib/global/qfeatures.h
new file mode 100644
index 0000000..20db0bf
--- /dev/null
+++ b/qtbase/src/corelib/global/qfeatures.h
@@ -0,0 +1,263 @@
+/*
+ * All feature dependencies.
+ *
+ * This list is generated by qmake from <qtbase>/src/corelib/global/qfeatures.txt
+ */
+#if !defined(QT_NO_DBUS) && (defined(QT_NO_PROPERTIES) || defined(QT_NO_XMLSTREAMREADER))
+#  define QT_NO_DBUS
+#endif
+#if !defined(QT_NO_ACCESSIBILITY) && (defined(QT_NO_PROPERTIES) || defined(QT_NO_MENUBAR))
+#  define QT_NO_ACCESSIBILITY
+#endif
+#if !defined(QT_NO_UNDOVIEW) && (defined(QT_NO_UNDOSTACK) || defined(QT_NO_LISTVIEW))
+#  define QT_NO_UNDOVIEW
+#endif
+#if !defined(QT_NO_UNDOSTACK) && (defined(QT_NO_UNDOCOMMAND))
+#  define QT_NO_UNDOSTACK
+#endif
+#if !defined(QT_NO_UNDOGROUP) && (defined(QT_NO_UNDOSTACK))
+#  define QT_NO_UNDOGROUP
+#endif
+#if !defined(QT_NO_FSCOMPLETER) && (defined(QT_NO_FILESYSTEMMODEL) || defined(QT_NO_COMPLETER))
+#  define QT_NO_FSCOMPLETER
+#endif
+#if !defined(QT_NO_BEARERMANAGEMENT) && (defined(QT_NO_LIBRARY) || defined(QT_NO_NETWORKINTERFACE) || defined(QT_NO_PROPERTIES))
+#  define QT_NO_BEARERMANAGEMENT
+#endif
+#if !defined(QT_NO_SOCKS5) && (defined(QT_NO_NETWORKPROXY))
+#  define QT_NO_SOCKS5
+#endif
+#if !defined(QT_NO_ICONV) && (defined(QT_NO_TEXTCODEC))
+#  define QT_NO_ICONV
+#endif
+#if !defined(QT_NO_BIG_CODECS) && (defined(QT_NO_TEXTCODEC))
+#  define QT_NO_BIG_CODECS
+#endif
+#if !defined(QT_NO_CODECS) && (defined(QT_NO_TEXTCODEC))
+#  define QT_NO_CODECS
+#endif
+#if !defined(QT_NO_CUPS) && (defined(QT_NO_PRINTER) || defined(QT_NO_LIBRARY))
+#  define QT_NO_CUPS
+#endif
+#if !defined(QT_NO_PRINTER) && (defined(QT_NO_PICTURE) || defined(QT_NO_TEMPORARYFILE) || defined(QT_NO_PDF))
+#  define QT_NO_PRINTER
+#endif
+#if !defined(QT_NO_STYLE_STYLESHEET) && (defined(QT_NO_STYLE_WINDOWS) || defined(QT_NO_PROPERTIES) || defined(QT_NO_CSSPARSER))
+#  define QT_NO_STYLE_STYLESHEET
+#endif
+#if !defined(QT_NO_STYLE_WINDOWSMOBILE) && (defined(QT_NO_STYLE_WINDOWS) || defined(QT_NO_IMAGEFORMAT_XPM))
+#  define QT_NO_STYLE_WINDOWSMOBILE
+#endif
+#if !defined(QT_NO_STYLE_WINDOWSCE) && (defined(QT_NO_STYLE_WINDOWS) || defined(QT_NO_IMAGEFORMAT_XPM))
+#  define QT_NO_STYLE_WINDOWSCE
+#endif
+#if !defined(QT_NO_STYLE_WINDOWSXP) && (defined(QT_NO_STYLE_WINDOWS))
+#  define QT_NO_STYLE_WINDOWSXP
+#endif
+#if !defined(QT_NO_STYLE_WINDOWSVISTA) && (defined(QT_NO_STYLE_WINDOWSXP))
+#  define QT_NO_STYLE_WINDOWSVISTA
+#endif
+#if !defined(QT_NO_DATAWIDGETMAPPER) && (defined(QT_NO_ITEMVIEWS) || defined(QT_NO_PROPERTIES))
+#  define QT_NO_DATAWIDGETMAPPER
+#endif
+#if !defined(QT_NO_DIRMODEL) && (defined(QT_NO_ITEMVIEWS) || defined(QT_NO_FILESYSTEMMODEL))
+#  define QT_NO_DIRMODEL
+#endif
+#if !defined(QT_NO_INPUTDIALOG) && (defined(QT_NO_COMBOBOX) || defined(QT_NO_SPINBOX) || defined(QT_NO_STACKEDWIDGET))
+#  define QT_NO_INPUTDIALOG
+#endif
+#if !defined(QT_NO_PRINTPREVIEWDIALOG) && (defined(QT_NO_PRINTPREVIEWWIDGET) || defined(QT_NO_PRINTDIALOG) || defined(QT_NO_TOOLBAR))
+#  define QT_NO_PRINTPREVIEWDIALOG
+#endif
+#if !defined(QT_NO_PRINTDIALOG) && (defined(QT_NO_PRINTER) || defined(QT_NO_COMBOBOX) || defined(QT_NO_BUTTONGROUP) || defined(QT_NO_SPINBOX) || defined(QT_NO_TREEVIEW) || defined(QT_NO_TABWIDGET))
+#  define QT_NO_PRINTDIALOG
+#endif
+#if !defined(QT_NO_FONTDIALOG) && (defined(QT_NO_STRINGLISTMODEL) || defined(QT_NO_COMBOBOX) || defined(QT_NO_VALIDATOR) || defined(QT_NO_GROUPBOX))
+#  define QT_NO_FONTDIALOG
+#endif
+#if !defined(QT_NO_FILEDIALOG) && (defined(QT_NO_DIRMODEL) || defined(QT_NO_TREEVIEW) || defined(QT_NO_COMBOBOX) || defined(QT_NO_TOOLBUTTON) || defined(QT_NO_BUTTONGROUP) || defined(QT_NO_TOOLTIP) || defined(QT_NO_SPLITTER) || defined(QT_NO_STACKEDWIDGET) || defined(QT_NO_PROXYMODEL))
+#  define QT_NO_FILEDIALOG
+#endif
+#if !defined(QT_NO_KEYSEQUENCEEDIT) && (defined(QT_NO_LINEEDIT) || defined(QT_NO_SHORTCUT))
+#  define QT_NO_KEYSEQUENCEEDIT
+#endif
+#if !defined(QT_NO_PRINTPREVIEWWIDGET) && (defined(QT_NO_GRAPHICSVIEW) || defined(QT_NO_PRINTER) || defined(QT_NO_MAINWINDOW))
+#  define QT_NO_PRINTPREVIEWWIDGET
+#endif
+#if !defined(QT_NO_CALENDARWIDGET) && (defined(QT_NO_TABLEVIEW) || defined(QT_NO_MENU) || defined(QT_NO_TEXTDATE) || defined(QT_NO_SPINBOX) || defined(QT_NO_TOOLBUTTON))
+#  define QT_NO_CALENDARWIDGET
+#endif
+#if !defined(QT_NO_PROGRESSDIALOG) && (defined(QT_NO_PROGRESSBAR))
+#  define QT_NO_PROGRESSDIALOG
+#endif
+#if !defined(QT_NO_MENUBAR) && (defined(QT_NO_MENU) || defined(QT_NO_TOOLBUTTON))
+#  define QT_NO_MENUBAR
+#endif
+#if !defined(QT_NO_DIAL) && (defined(QT_NO_SLIDER))
+#  define QT_NO_DIAL
+#endif
+#if !defined(QT_NO_SCROLLBAR) && (defined(QT_NO_SLIDER))
+#  define QT_NO_SCROLLBAR
+#endif
+#if !defined(QT_NO_SCROLLAREA) && (defined(QT_NO_SCROLLBAR))
+#  define QT_NO_SCROLLAREA
+#endif
+#if !defined(QT_NO_GRAPHICSVIEW) && (defined(QT_NO_SCROLLAREA))
+#  define QT_NO_GRAPHICSVIEW
+#endif
+#if !defined(QT_NO_GRAPHICSEFFECT) && (defined(QT_NO_GRAPHICSVIEW))
+#  define QT_NO_GRAPHICSEFFECT
+#endif
+#if !defined(QT_NO_MDIAREA) && (defined(QT_NO_SCROLLAREA))
+#  define QT_NO_MDIAREA
+#endif
+#if !defined(QT_NO_DOCKWIDGET) && (defined(QT_NO_RUBBERBAND) || defined(QT_NO_MAINWINDOW))
+#  define QT_NO_DOCKWIDGET
+#endif
+#if !defined(QT_NO_BUTTONGROUP) && (defined(QT_NO_GROUPBOX))
+#  define QT_NO_BUTTONGROUP
+#endif
+#if !defined(QT_NO_TOOLBOX) && (defined(QT_NO_TOOLBUTTON) || defined(QT_NO_SCROLLAREA))
+#  define QT_NO_TOOLBOX
+#endif
+#if !defined(QT_NO_MAINWINDOW) && (defined(QT_NO_MENU) || defined(QT_NO_RESIZEHANDLER) || defined(QT_NO_TOOLBUTTON))
+#  define QT_NO_MAINWINDOW
+#endif
+#if !defined(QT_NO_TOOLBAR) && (defined(QT_NO_MAINWINDOW))
+#  define QT_NO_TOOLBAR
+#endif
+#if !defined(QT_NO_FONTCOMBOBOX) && (defined(QT_NO_COMBOBOX) || defined(QT_NO_STRINGLISTMODEL))
+#  define QT_NO_FONTCOMBOBOX
+#endif
+#if !defined(QT_NO_COMBOBOX) && (defined(QT_NO_LINEEDIT) || defined(QT_NO_STANDARDITEMMODEL) || defined(QT_NO_LISTVIEW))
+#  define QT_NO_COMBOBOX
+#endif
+#if !defined(QT_NO_TABWIDGET) && (defined(QT_NO_TABBAR) || defined(QT_NO_STACKEDWIDGET))
+#  define QT_NO_TABWIDGET
+#endif
+#if !defined(QT_NO_SPINBOX) && (defined(QT_NO_SPINWIDGET) || defined(QT_NO_LINEEDIT) || defined(QT_NO_VALIDATOR))
+#  define QT_NO_SPINBOX
+#endif
+#if !defined(QT_NO_COLORDIALOG) && (defined(QT_NO_SPINBOX))
+#  define QT_NO_COLORDIALOG
+#endif
+#if !defined(QT_NO_SPLITTER) && (defined(QT_NO_RUBBERBAND))
+#  define QT_NO_SPLITTER
+#endif
+#if !defined(QT_NO_TEXTEDIT) && (defined(QT_NO_SCROLLAREA) || defined(QT_NO_PROPERTIES))
+#  define QT_NO_TEXTEDIT
+#endif
+#if !defined(QT_NO_ERRORMESSAGE) && (defined(QT_NO_TEXTEDIT))
+#  define QT_NO_ERRORMESSAGE
+#endif
+#if !defined(QT_NO_SYNTAXHIGHLIGHTER) && (defined(QT_NO_TEXTEDIT))
+#  define QT_NO_SYNTAXHIGHLIGHTER
+#endif
+#if !defined(QT_NO_TEXTBROWSER) && (defined(QT_NO_TEXTEDIT))
+#  define QT_NO_TEXTBROWSER
+#endif
+#if !defined(QT_NO_DATETIMEEDIT) && (defined(QT_NO_CALENDARWIDGET) || defined(QT_NO_DATESTRING))
+#  define QT_NO_DATETIMEEDIT
+#endif
+#if !defined(QT_NO_ITEMVIEWS) && (defined(QT_NO_RUBBERBAND) || defined(QT_NO_SCROLLAREA))
+#  define QT_NO_ITEMVIEWS
+#endif
+#if !defined(QT_NO_STRINGLISTMODEL) && (defined(QT_NO_ITEMVIEWS))
+#  define QT_NO_STRINGLISTMODEL
+#endif
+#if !defined(QT_NO_PROXYMODEL) && (defined(QT_NO_ITEMVIEWS))
+#  define QT_NO_PROXYMODEL
+#endif
+#if !defined(QT_NO_COMPLETER) && (defined(QT_NO_PROXYMODEL))
+#  define QT_NO_COMPLETER
+#endif
+#if !defined(QT_NO_IDENTITYPROXYMODEL) && (defined(QT_NO_PROXYMODEL))
+#  define QT_NO_IDENTITYPROXYMODEL
+#endif
+#if !defined(QT_NO_SORTFILTERPROXYMODEL) && (defined(QT_NO_PROXYMODEL))
+#  define QT_NO_SORTFILTERPROXYMODEL
+#endif
+#if !defined(QT_NO_STANDARDITEMMODEL) && (defined(QT_NO_ITEMVIEWS))
+#  define QT_NO_STANDARDITEMMODEL
+#endif
+#if !defined(QT_NO_TABLEVIEW) && (defined(QT_NO_ITEMVIEWS))
+#  define QT_NO_TABLEVIEW
+#endif
+#if !defined(QT_NO_TABLEWIDGET) && (defined(QT_NO_TABLEVIEW))
+#  define QT_NO_TABLEWIDGET
+#endif
+#if !defined(QT_NO_LISTVIEW) && (defined(QT_NO_ITEMVIEWS))
+#  define QT_NO_LISTVIEW
+#endif
+#if !defined(QT_NO_COLUMNVIEW) && (defined(QT_NO_LISTVIEW))
+#  define QT_NO_COLUMNVIEW
+#endif
+#if !defined(QT_NO_LISTWIDGET) && (defined(QT_NO_LISTVIEW))
+#  define QT_NO_LISTWIDGET
+#endif
+#if !defined(QT_NO_TREEVIEW) && (defined(QT_NO_ITEMVIEWS))
+#  define QT_NO_TREEVIEW
+#endif
+#if !defined(QT_NO_TREEWIDGET) && (defined(QT_NO_TREEVIEW))
+#  define QT_NO_TREEWIDGET
+#endif
+#if !defined(QT_NO_LOCALSERVER) && (defined(QT_NO_TEMPORARYFILE))
+#  define QT_NO_LOCALSERVER
+#endif
+#if !defined(QT_NO_NETWORKDISKCACHE) && (defined(QT_NO_TEMPORARYFILE))
+#  define QT_NO_NETWORKDISKCACHE
+#endif
+#if !defined(QT_NO_PDF) && (defined(QT_NO_TEMPORARYFILE))
+#  define QT_NO_PDF
+#endif
+#if !defined(QT_NO_FTP) && (defined(QT_NO_TEXTDATE))
+#  define QT_NO_FTP
+#endif
+#if !defined(QT_NO_DATESTRING) && (defined(QT_NO_TEXTDATE))
+#  define QT_NO_DATESTRING
+#endif
+#if !defined(QT_NO_IMAGEFORMATPLUGIN) && (defined(QT_NO_LIBRARY))
+#  define QT_NO_IMAGEFORMATPLUGIN
+#endif
+#if !defined(QT_NO_IM) && (defined(QT_NO_LIBRARY))
+#  define QT_NO_IM
+#endif
+#if !defined(QT_NO_TOOLBUTTON) && (defined(QT_NO_ACTION))
+#  define QT_NO_TOOLBUTTON
+#endif
+#if !defined(QT_NO_WHATSTHIS) && (defined(QT_NO_TOOLBUTTON))
+#  define QT_NO_WHATSTHIS
+#endif
+#if !defined(QT_NO_TABBAR) && (defined(QT_NO_TOOLBUTTON))
+#  define QT_NO_TABBAR
+#endif
+#if !defined(QT_NO_MENU) && (defined(QT_NO_ACTION))
+#  define QT_NO_MENU
+#endif
+#if !defined(QT_NO_CONTEXTMENU) && (defined(QT_NO_MENU))
+#  define QT_NO_CONTEXTMENU
+#endif
+#if !defined(QT_NO_STYLE_FUSION) && (defined(QT_NO_IMAGEFORMAT_XPM))
+#  define QT_NO_STYLE_FUSION
+#endif
+#if !defined(QT_NO_DRAGANDDROP) && (defined(QT_NO_IMAGEFORMAT_XPM))
+#  define QT_NO_DRAGANDDROP
+#endif
+#if !defined(QT_NO_XMLSTREAMREADER) && (defined(QT_NO_XMLSTREAM))
+#  define QT_NO_XMLSTREAMREADER
+#endif
+#if !defined(QT_NO_XMLSTREAMWRITER) && (defined(QT_NO_XMLSTREAM))
+#  define QT_NO_XMLSTREAMWRITER
+#endif
+#if !defined(QT_NO_TEXTODFWRITER) && (defined(QT_NO_XMLSTREAMWRITER))
+#  define QT_NO_TEXTODFWRITER
+#endif
+#if !defined(QT_NO_STATEMACHINE) && (defined(QT_NO_PROPERTIES))
+#  define QT_NO_STATEMACHINE
+#endif
+#if !defined(QT_NO_ANIMATION) && (defined(QT_NO_PROPERTIES))
+#  define QT_NO_ANIMATION
+#endif
+#if !defined(QT_NO_WIZARD) && (defined(QT_NO_PROPERTIES))
+#  define QT_NO_WIZARD
+#endif
diff --git a/qtbase/src/corelib/global/qglobal.h b/qtbase/src/corelib/global/qglobal.h
index cbba640..d758666 100644
--- a/qtbase/src/corelib/global/qglobal.h
+++ b/qtbase/src/corelib/global/qglobal.h
@@ -833,13 +833,17 @@ inline void qSwap(T &value1, T &value2)
     swap(value1, value2);
 }
 
-#if QT_DEPRECATED_SINCE(5, 0)
+#ifndef Q_OS_GENODE
+ #if QT_DEPRECATED_SINCE(5, 0)
+ #endif
+#else
+/* QtScript classic still needs these functions */
 Q_CORE_EXPORT QT_DEPRECATED void *qMalloc(size_t size) Q_ALLOC_SIZE(1);
 Q_CORE_EXPORT QT_DEPRECATED void qFree(void *ptr);
 Q_CORE_EXPORT QT_DEPRECATED void *qRealloc(void *ptr, size_t size) Q_ALLOC_SIZE(2);
 Q_CORE_EXPORT QT_DEPRECATED void *qMemCopy(void *dest, const void *src, size_t n);
 Q_CORE_EXPORT QT_DEPRECATED void *qMemSet(void *dest, int c, size_t n);
-#endif
+#endif /* Q_OS_GENODE */
 Q_CORE_EXPORT void *qMallocAligned(size_t size, size_t alignment) Q_ALLOC_SIZE(1);
 Q_CORE_EXPORT void *qReallocAligned(void *ptr, size_t size, size_t oldsize, size_t alignment) Q_ALLOC_SIZE(2);
 Q_CORE_EXPORT void qFreeAligned(void *ptr);
diff --git a/qtbase/src/corelib/global/qlogging.cpp b/qtbase/src/corelib/global/qlogging.cpp
index 88882bb..d58bca2 100644
--- a/qtbase/src/corelib/global/qlogging.cpp
+++ b/qtbase/src/corelib/global/qlogging.cpp
@@ -60,6 +60,11 @@
 #include <android/log.h>
 #endif
 
+#ifdef Q_OS_GENODE
+#include <base/printf.h>
+#undef Q_COMPILER_THREAD_LOCAL
+#endif
+
 #if defined(QT_USE_JOURNALD) && !defined(QT_BOOTSTRAPPED)
 # define SD_JOURNAL_SUPPRESS_LOCATION
 # include <systemd/sd-journal.h>
@@ -1475,6 +1480,9 @@ static void qDefaultMessageHandler(QtMsgType type, const QMessageLogContext &con
         logMessage.append(QLatin1Char('\n'));
         slog2_default_handler(type, logMessage.toLocal8Bit().constData());
         return;
+#elif defined(Q_OS_GENODE)
+        PDBG("%s", logMessage.toLocal8Bit().constData());
+        return;
 #elif defined(QT_USE_JOURNALD) && !defined(QT_BOOTSTRAPPED)
         systemd_default_message_handler(type, context, logMessage);
         return;
diff --git a/qtbase/src/corelib/global/qsystemdetection.h b/qtbase/src/corelib/global/qsystemdetection.h
index 562427e..ec7b95c 100644
--- a/qtbase/src/corelib/global/qsystemdetection.h
+++ b/qtbase/src/corelib/global/qsystemdetection.h
@@ -41,6 +41,7 @@
 /*
    The operating system, must be one of: (Q_OS_x)
 
+     GENODE   - GenodeOS Framework
      DARWIN   - Any Darwin system
      MAC      - OS X and iOS
      OSX      - OS X
@@ -86,7 +87,9 @@
               - Q_OS_FREEBSD_KERNEL is always defined on FreeBSD, even if the userland is from GNU
 */
 
-#if defined(__APPLE__) && (defined(__GNUC__) || defined(__xlC__) || defined(__xlc__))
+#if defined(__GENODE__)
+#  define Q_OS_GENODE
+#elif defined(__APPLE__) && (defined(__GNUC__) || defined(__xlC__) || defined(__xlc__))
 #  define Q_OS_DARWIN
 #  define Q_OS_BSD4
 #  ifdef __LP64__
diff --git a/qtbase/src/corelib/io/qprocess.cpp b/qtbase/src/corelib/io/qprocess.cpp
index 1842541..89e2953 100644
--- a/qtbase/src/corelib/io/qprocess.cpp
+++ b/qtbase/src/corelib/io/qprocess.cpp
@@ -96,6 +96,11 @@ QT_END_NAMESPACE
 #include <private/qcore_unix_p.h>
 #endif
 
+#ifdef Q_OS_GENODE
+#include <rom_session/connection.h>
+#include <util/xml_node.h>
+#endif
+
 #ifndef QT_NO_PROCESS
 
 QT_BEGIN_NAMESPACE
@@ -825,6 +830,65 @@ QProcessPrivate::QProcessPrivate()
     stdinWriteTrigger = 0;
     processFinishedNotifier = 0;
 #endif // Q_OS_WIN
+#ifdef Q_OS_GENODE
+    launchpad_child = 0;
+
+    /* request config file from ROM service */
+    Genode::Rom_connection rom("config");
+    rom.on_destruction(Genode::Rom_connection::KEEP_OPEN);
+    void *addr;
+    try {
+        addr = Genode::env()->rm_session()->attach(rom.dataspace());
+    } catch(Genode::Parent::Service_denied) {
+        qWarning("Error: Couldn't open config file.");
+        return;
+    }
+
+    /*
+     * The XML data of a valid config file starts with
+     * a <config> tag.
+     */
+    Genode::Xml_node config_node((const char *)addr);
+
+    if (!config_node.has_type("config")) {
+        qWarning("Error: Root node of config file is not a <config> tag.");
+        return;
+    }
+
+    /*
+     * Iterate through all entries of the config file and start
+     * children as specified.
+     */
+    for (int i = 0; i < config_node.num_sub_nodes(); i++) {
+        Genode::Xml_node program_node = config_node.sub_node(i);
+        if (program_node.has_type("program")) {
+
+            /* add filename and ram_quota to ram_quota_hash */
+            char filename[32];
+            try {
+                program_node.sub_node("filename").value(filename, sizeof(filename));
+            } catch (Genode::Xml_node::Nonexistent_sub_node) {
+                qWarning("Warning: Missing valid <filename> in config-file entry.");
+                return;
+            }
+
+            size_t ram_quota = 0;
+            try {
+                program_node.sub_node("ram_quota").value(&ram_quota);
+            } catch (Genode::Xml_node::Nonexistent_sub_node) {
+                qWarning("Warning: Missing valid <ram_quota> in config-file entry.");
+                return;
+            }
+
+            ram_quota_hash()->insert(QString(filename), ram_quota);
+        } else {
+            char buf[32];
+            program_node.type_name(buf, sizeof(buf));
+            qWarning("Warning: Ignoring unsupported tag <%s>.", buf);
+        }
+    }
+
+#endif
 }
 
 /*!
diff --git a/qtbase/src/corelib/io/qprocess_p.h b/qtbase/src/corelib/io/qprocess_p.h
index f6bd64f..aaf54f9 100644
--- a/qtbase/src/corelib/io/qprocess_p.h
+++ b/qtbase/src/corelib/io/qprocess_p.h
@@ -69,6 +69,11 @@ typedef int Q_PIPE;
 
 #ifndef QT_NO_PROCESS
 
+#ifdef Q_OS_GENODE
+#include <base/env.h>
+#include <launchpad/launchpad.h>
+#endif
+
 QT_BEGIN_NAMESPACE
 
 class QSocketNotifier;
@@ -230,6 +235,28 @@ template<> Q_INLINE_TEMPLATE void QSharedDataPointer<QProcessEnvironmentPrivate>
     d = x;
 }
 
+#ifdef Q_OS_GENODE
+
+class QProcess_launchpad : public Launchpad
+{
+public:
+    QProcess_launchpad(unsigned long initial_quota) : Launchpad(initial_quota) {}
+
+    virtual void quota(unsigned long quota) {}
+
+    virtual void add_launcher(const char *filename,
+                              unsigned long default_quota) {}
+
+    virtual void add_child(const char *unique_name,
+                           unsigned long quota,
+                           Launchpad_child *launchpad_child,
+                           Genode::Allocator *alloc) {}
+
+    virtual void remove_child(const char *name, Genode::Allocator *alloc) {}
+};
+
+#endif
+
 class QProcessPrivate : public QIODevicePrivate
 {
 public:
@@ -347,7 +374,7 @@ public:
 
     void start(QIODevice::OpenMode mode);
     void startProcess();
-#if defined(Q_OS_UNIX) && !defined(QPROCESS_USE_SPAWN)
+#if defined(Q_OS_UNIX) && !defined(QPROCESS_USE_SPAWN) && !defined(Q_OS_GENODE)
     void execChild(const char *workingDirectory, char **path, char **argv, char **envp);
 #elif defined(QPROCESS_USE_SPAWN)
     pid_t spawnChild(pid_t *ppid, const char *workingDirectory, char **argv, char **envp);
@@ -372,6 +399,22 @@ public:
     QProcess::ExitStatus exitStatus;
     bool crashed;
 
+#ifdef Q_OS_GENODE
+    static QProcess_launchpad *launchpad()
+    {
+      static QProcess_launchpad _launchpad(Genode::env()->ram_session()->quota());
+      return &_launchpad;
+    }
+
+    static QHash<QString, size_t> *ram_quota_hash()
+    {
+        static QHash<QString, size_t> _ram_quota_hash;
+        return &_ram_quota_hash;
+    }
+
+    Launchpad_child *launchpad_child;
+#endif
+
     bool waitForStarted(int msecs = 30000);
     bool waitForReadyRead(int msecs = 30000);
     bool waitForBytesWritten(int msecs = 30000);
diff --git a/qtbase/src/corelib/io/qresource.cpp b/qtbase/src/corelib/io/qresource.cpp
index 4b85645..c869ee0 100644
--- a/qtbase/src/corelib/io/qresource.cpp
+++ b/qtbase/src/corelib/io/qresource.cpp
@@ -922,7 +922,7 @@ public:
     }
 };
 
-#if defined(Q_OS_UNIX) && !defined (Q_OS_NACL) && !defined(Q_OS_INTEGRITY)
+#if defined(Q_OS_UNIX) && !defined (Q_OS_NACL) && !defined(Q_OS_INTEGRITY) && !defined(Q_OS_GENODE)
 #define QT_USE_MMAP
 #endif
 
diff --git a/qtbase/src/corelib/kernel/qcoreapplication.cpp b/qtbase/src/corelib/kernel/qcoreapplication.cpp
index ecafe91..96b9d8b 100644
--- a/qtbase/src/corelib/kernel/qcoreapplication.cpp
+++ b/qtbase/src/corelib/kernel/qcoreapplication.cpp
@@ -587,7 +587,7 @@ void QCoreApplicationPrivate::initLocale()
     if (qt_locale_initialized)
         return;
     qt_locale_initialized = true;
-#ifdef Q_OS_UNIX
+#if defined(Q_OS_UNIX) && !defined(Q_OS_GENODE)
     setlocale(LC_ALL, "");
 #endif
 }
diff --git a/qtbase/src/corelib/kernel/qeventdispatcher_unix.cpp b/qtbase/src/corelib/kernel/qeventdispatcher_unix.cpp
index 155f7b7..a69602d 100644
--- a/qtbase/src/corelib/kernel/qeventdispatcher_unix.cpp
+++ b/qtbase/src/corelib/kernel/qeventdispatcher_unix.cpp
@@ -66,6 +66,11 @@
 #  include <sys/times.h>
 #endif
 
+#ifdef Q_OS_GENODE
+#include <timer_session/connection.h>
+#define perror PERR
+#endif /* Q_OS_GENODE */
+
 QT_BEGIN_NAMESPACE
 
 #if defined(Q_OS_INTEGRITY) || defined(Q_OS_VXWORKS)
@@ -279,6 +284,9 @@ int QEventDispatcherUNIXPrivate::processThreadWakeUp(int nsel)
         char c[16];
         ::read(thread_pipe[0], c, sizeof(c));
         ::ioctl(thread_pipe[0], FIOFLUSH, 0);
+#elif defined(Q_OS_GENODE)
+       char c[16];
+        ::read(thread_pipe[0], c, sizeof(c)); // FIXME: the while loop only works in non-blocking mode
 #else
 #  ifndef QT_NO_EVENTFD
         if (thread_pipe[1] == -1) {
@@ -317,6 +325,12 @@ QEventDispatcherUNIX::~QEventDispatcherUNIX()
 int QEventDispatcherUNIX::select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds,
                                  timespec *timeout)
 {
+#ifdef Q_OS_GENODE
+   /* if < 10ms round up to the 10ms minimum granularity supported by
+    * the timed semaphore */
+   if (timeout && (timeout->tv_sec == 0) && (timeout->tv_nsec > 0) && (timeout->tv_nsec < 10*1000*1000))
+       timeout->tv_nsec = 10*1000*1000;
+#endif /* Q_OS_GENODE */
     return qt_safe_select(nfds, readfds, writefds, exceptfds, timeout);
 }
 
diff --git a/qtbase/src/corelib/kernel/qobject.h b/qtbase/src/corelib/kernel/qobject.h
index 5f61dd9..1f82875 100644
--- a/qtbase/src/corelib/kernel/qobject.h
+++ b/qtbase/src/corelib/kernel/qobject.h
@@ -422,7 +422,7 @@ public:
         { return const_cast<QObject *>(this)->qt_metacast(classname) != 0; }
 
 public Q_SLOTS:
-    void deleteLater();
+    virtual void deleteLater();
 
 protected:
     QObject *sender() const;
diff --git a/qtbase/src/corelib/kernel/qtranslator.cpp b/qtbase/src/corelib/kernel/qtranslator.cpp
index a405df5..1055388 100644
--- a/qtbase/src/corelib/kernel/qtranslator.cpp
+++ b/qtbase/src/corelib/kernel/qtranslator.cpp
@@ -52,7 +52,7 @@
 #include "qendian.h"
 #include "qresource.h"
 
-#if defined(Q_OS_UNIX) && !defined(Q_OS_INTEGRITY)
+#if defined(Q_OS_UNIX) && !defined(Q_OS_INTEGRITY) && !defined(Q_OS_GENODE)
 #define QT_USE_MMAP
 #include "private/qcore_unix_p.h"
 #endif
diff --git a/qtbase/src/corelib/kernel/qvariant_p.h b/qtbase/src/corelib/kernel/qvariant_p.h
index 3b30b12..3978a2a 100644
--- a/qtbase/src/corelib/kernel/qvariant_p.h
+++ b/qtbase/src/corelib/kernel/qvariant_p.h
@@ -391,7 +391,10 @@ public:
 
     void delegate(const void*)
     {
+#ifndef Q_OS_GENODE
+        /* this warning appears often when using the QtScript classic lib (tetrix), not sure if it is serious */
         qWarning("Trying to create a QVariant instance of QMetaType::Void type, an invalid QVariant will be constructed instead");
+#endif
         m_x->type = QMetaType::UnknownType;
         m_x->is_shared = false;
         m_x->is_null = !m_copy;
diff --git a/qtbase/src/corelib/thread/qthread.cpp b/qtbase/src/corelib/thread/qthread.cpp
index dc231a0..fa678bc 100644
--- a/qtbase/src/corelib/thread/qthread.cpp
+++ b/qtbase/src/corelib/thread/qthread.cpp
@@ -144,6 +144,9 @@ QThreadPrivate::QThreadPrivate(QThreadData *d)
 {
 #if defined (Q_OS_UNIX)
     thread_id = 0;
+#ifdef Q_OS_GENODE
+    genode_thread = 0;
+#endif /* Q_OS_GENODE */
 #elif defined (Q_OS_WIN)
     handle = 0;
 #  ifndef Q_OS_WINRT
diff --git a/qtbase/src/corelib/thread/qthread_p.h b/qtbase/src/corelib/thread/qthread_p.h
index 2008f76..99f1564 100644
--- a/qtbase/src/corelib/thread/qthread_p.h
+++ b/qtbase/src/corelib/thread/qthread_p.h
@@ -46,6 +46,10 @@
 //
 //
 
+#ifdef Q_OS_GENODE
+#include <thread_qt.h>
+#endif
+
 #include "qplatformdefs.h"
 #include "QtCore/qthread.h"
 #include "QtCore/qmutex.h"
@@ -162,12 +166,63 @@ public:
     static QThread *threadForId(int id);
 
 #ifdef Q_OS_UNIX
+#ifdef Q_OS_GENODE
+
+    class Genode_thread : public Genode::Thread_qt
+    {
+        private:
+
+           /*
+            * The '_finished_lock' is necessary because 'QThreadPrivate::mutex'
+            * uses a 'Genode::Timed_semaphore' internally and it isn't safe
+            * to delete a Genode thread that just called 'Semaphore::up()',
+            * because the 'Semaphore::_meta_lock' could still be locked.
+            */
+            Genode::Lock _finished_lock;
+            QThread *_qthread;
+
+        public:
+
+            Genode_thread(QThread *qthread)
+            : _finished_lock(Genode::Lock::LOCKED),
+              _qthread(qthread) { }
+
+            virtual void entry()
+            {
+                QThreadPrivate::start(_qthread);
+                QThreadPrivate::finish(_qthread);
+                _finished_lock.unlock();
+            }
+
+            void join()
+            {
+                _finished_lock.lock();
+            }
+    };
+
+    Genode_thread *genode_thread;
+
+    struct tls_struct {
+      QThreadData *data;
+      bool termination_enabled;
+    };
+
+    static QHash<Qt::HANDLE, struct tls_struct> tls;
+
+    Qt::HANDLE thread_id;
+    QWaitCondition thread_done;
+
+    static void *start(void *arg);
+    static void finish(void *arg);
+
+#else // Q_OS_UNIX && !Q_OS_GENODE
     pthread_t thread_id;
     QWaitCondition thread_done;
 
     static void *start(void *arg);
     static void finish(void *);
 
+#endif // Q_OS_GENODE
 #endif // Q_OS_UNIX
 
 #ifdef Q_OS_WIN
diff --git a/qtbase/src/corelib/tools/qarraydata.cpp b/qtbase/src/corelib/tools/qarraydata.cpp
index ef15fae..ee8cb41 100644
--- a/qtbase/src/corelib/tools/qarraydata.cpp
+++ b/qtbase/src/corelib/tools/qarraydata.cpp
@@ -100,8 +100,8 @@ QArrayData *QArrayData::allocate(size_t objectSize, size_t alignment,
 
     QArrayData *header = static_cast<QArrayData *>(::malloc(allocSize));
     if (header) {
-        quintptr data = (quintptr(header) + sizeof(QArrayData) + alignment - 1)
-                & ~(alignment - 1);
+        quintptr data = (quintptr(header) + sizeof(QArrayData) + /*alignment*/4 - 1)
+                & ~(/*alignment*/4 - 1);
 
         header->ref.atomic.store(bool(!(options & Unsharable)));
         header->size = 0;
diff --git a/qtbase/src/corelib/tools/qdatetime.cpp b/qtbase/src/corelib/tools/qdatetime.cpp
index e445055..179ac83 100644
--- a/qtbase/src/corelib/tools/qdatetime.cpp
+++ b/qtbase/src/corelib/tools/qdatetime.cpp
@@ -2148,6 +2148,9 @@ static int qt_timezone()
         // - It also takes DST into account, so we need to adjust it to always
         //   get the Standard Time offset.
         return -t.tm_gmtoff + (t.tm_isdst ? SECS_PER_HOUR : 0L);
+#elif defined (Q_OS_GENODE)
+# warning No timezone on GenodeOS
+        return 0;
 #else
         return timezone;
 #endif // Q_OS_WIN
